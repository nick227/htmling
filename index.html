<!DOCTYPE html>
<html>
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
        <title>{}</title>
        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <script src="//ajax.googleapis.com/ajax/libs/jquery/2.1.1/jquery.min.js"></script>
        <style>
        	html,body{
        		width:100%;
        		height: 100%;
        		padding:0;
        		margin:0;
        	}
        	.small{
        		font-size:9px;
        	}
        </style>
    </head>
<body>
<form id="form-main" action='http://htmling.herokuapp.com' enctype="text/plain" style="position:fixed; top:0;background-color: rgba(255,255,255,.25);">
	<select name="template">
		<option value="kindle">kindle</option>
		<option value="default">default</option>
	</select>

	<input type="text" style="width:260px;" name="url" value="https://en.wikipedia.org/wiki/Thessaly" placeholder="website address" /> <span class="small">e.g. https://en.wikipedia.org/wiki/Thessaly</span>
	<br>
	<textarea placeholder="paste html" rows=1 cols = 30 name="blob"></textarea><br>
	<input type="submit">

</form>
<section id="stage" style="margin-top:55px;"></section>

<script type="text/javascript">

  if (window.addEventListener){
  	window.addEventListener("load", ready, false);
  }else if(window.attachEvent){
      window.attachEvent("onload", ready);
  	}


function ready(){

	$('form#form-main').on("submit", function(e){
		e.preventDefault();
		var payload = $(this).serialize();
		$.post(this.action, payload, function(res){
			var elm = document.getElementById("stage");
			elm.innerHTML = res.html;
			$('#htmling-script').remove();
		    var script = document.createElement("script");
		    script.type = "text/javascript";
		    script.setAttribute('id', 'htmling-script');
		    script.appendChild(document.createTextNode(res.script));
		    document.body.appendChild(script);
		});

	});

};


</script>
</body>
</html>    